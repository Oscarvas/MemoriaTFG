%---------------------------------------------------------------------
%
%                          Capítulo 13
%
%---------------------------------------------------------------------
\chapter{Trabajo Individual}

\begin{FraseCelebre}
\begin{Frase}
\end{Frase}
\begin{Fuente}
\end{Fuente}
\end{FraseCelebre}

Antes de empezar es importante señalar que el trabajo hecho para el desarrollo de esta investigación ha sido realmente extenso. Si bien hay ciertas partes que se pueden dividir en tareas que ha realizado de manera individual cada uno de los miembros, es importante señalar que sin la ayuda de todos no se habrían conseguido cotas tan altas. Las reuniones de contenidos, opiniones, revisiones y modificaciones son difíciles de detallar para explicar de manera precisa donde acaba la aportación de un integrante y empieza la de otro. A continuación se procederá a intentar explicar de la mejor manera posible las aportaciones individuales de cada uno, teniendo siempre en cuenta esta premisa.

\section{Trabajo realizado por Juan Orellana Quemada}
Para empezar mi aportación a esta investigación me documente bien sobre la misma, pues nunca había trabajado ni con generadores de historias ni con agentes inteligentes ni con un planificador. Para ello, y como se partía de una investigación anterior, tuve que leer profundamente la memoria de la misma así como los artículos referenciados en ella, haciendo especial hincapié en aquellos que nos proporcionaba nuestro director del proyecto.

A partir de aquí, me volqué en el diseño de nuestro generador de historias. Como no teníamos muy claro que queríamos hacer en un principio, participé activamente en el \textit{brainstorming} inicial, y poco a poco conseguimos buenas ideas junto a la ayuda de nuestro tutor, detalladas mas extensamente en el Capitulo de \ref{cap:Objetivos}. 

Como tampoco podíamos paralizar la implementación, en cuanto tuvimos un objetivo claro, en este caso el de los personajes con múltiples objetivos, realice las primeras pruebas de modificaciones en la aplicación, hasta que al no conseguir avances hubo que rehacerla, tal y como se detalla en el Capítulo \ref{cap:PrimerosPasos}. En concreto todas las pruebas del villano fueron realizadas por mi.

Mientras intentaba esto, también desarrollé el primer prototipo de memoria de la aplicación, de forma que aquellas partes en las que el diseño era claro iban tomando forma poco a poco dando lugar a unos objetivos claros hacia los que encaminar nuestro trabajo. Sin embargo hablaré del resto de mi aportación a la memoria más tarde.

Cuando empezó la implementación de nuestra aplicación definitiva, aprendí de mi compañero Oscar los fundamentos de la misma, pues él llevaba la voz cantante en este aspecto.
Cuando adquirí el suficiente conocimiento, implementé la primera beta de la acción \texttt{Batalla}, y construí el SCD de los PNJ's.

Es a partir de este momento cuando decidimos que queremos una aplicación altamente configurable, y es en este apartado donde he realizado mi principal aportación al proyecto.

Lo primero que intente fue tratar de hacer a los personajes lo mas configurables posibles. Para ello, debí crear una nueva estructura para los propios personajes, a través de una superclase y el uso de la herencia (el resultado final de esta arquitectura se puede ver en la figura \ref{fig:DCPersonajes}) . Para ello, fue necesario crear las clases \texttt{Protagonista} y \texttt{Antagonista}, de la misma manera que tuve que rehacer \texttt{PNJ}, de manera que todas las clases pudiesen interpretar correctamente los datos de la superclase.
Estos cambios en la estructura me permitieron configurar los personajes de una manera más eficaz, de manera que les añadí atributos para favorecer la narración, como por ejemplo en un antagonista su \texttt{sexo} o su \texttt{especie}. Esto, junto al atributo \texttt{clase}, me permitía configurar los detalles de un antagonista, de manera que con un mismo arquetipo de configuración conseguía resultados muy distintos, como por ejemplo los que muestro en el Cuadro \ref{ejemploantagonistasXML}.

\lstset{frameround=fttt}
\begin{lstlisting}[basicstyle=\scriptsize,frame=trBL,caption={Ejemplo de código de creacion de antagonistas},label=ejemploantagonistasXML]

<Actores>
	<monstruo nombre="Smaug" clase="Secuestrador" 
		especie="Dragon" sexo="M"/>
	<monstruo nombre="Florecilla" clase="Secuestrador"
		 especie="Dragon" sexo="F"/>
	<monstruo nombre="Scar" clase="Secuestrador"
		 especie="Tigre" sexo="M"/>
</Actores>
\end{lstlisting}  

De esta manera, puedo conseguir al dragón Smaug, la dragona Florecilla o el tigre Scar, y todos actuaran como un antagonista secuestrador. La gracia de esta implementación reside en que la historia cambia totalmente cuando se narra, gracias a los atributos nuevos y la abstracción con la que se han construido las clases de personajes.

Cuando implementé estos cambios, se hizo patente la necesidad de cambiar los archivos XML y los SCD que los cargaban. De esta manera, configuré correctamente el SCD, lo cual provocó que se debía cambiar la manera en la que se iniciaba cada personaje de manera individual y tuvé que realizar los cambios oportunos.


Mi siguiente trabajo fue cambiar el mapa, tratando de permitir al usuario modificarlo a su gusto. Al rehacer el mapa de la manera mas configurable posible decidí darle tipos a las localizaciones, consultable en el Capítulo \ref{cap:Mapa:ClaseMapaLocalizacion}, de manera que los personajes se situaban al crearse según su clase en estos distintos tipos, tal y como se muestra en la Figura \ref{cap:Mapa:LocalizacionesAleatoriasSegunClase}. Todas estas características están implementadas en la interfaz \texttt{Vocabulario}, donde se definen los diferentes tipos de localizaciones que se pueden tener, así como en la clase \texttt{Mitologia} donde se especifica la relación entre cada clase y su localización.
Para conseguir satisfactoriamente este cambio, tuve que crear una arquitectura funcional para el mismo, creando la clase localización para poder interpretar correctamente el mapa y revisando la conexión entre la clase \texttt{Mapa} y el \texttt{Agente Mundo}, de manera que este agente pudiese interpretar correctamente el mapa (el diagrama de esta arquitectura es consultable en la figura \ref{fig:DCMapa}). 

Lo único que quedaba sin ser configurable en la aplicación eran las razas, así que me puse con ello. Originalmente, las razas se cargaban directamente desde un enumerado implementado dentro de la aplicación, de manera que para hacerlas configurables tuve que crear su propia clase, asi como modificar su XML y crear un SCD acorde a él. De igual manera, tuve que modificar la clase \texttt{Protagonista} para que las razas fuesen cargadas correctamente y hacer que esta clase pudiese interactuar correctamente con la clase raza, conseguido a través de su vínculo común con el \texttt{Agente Mundo}. 

Por último realice la implementación del \texttt{Ayudante del Héroe}. Para crear este agente, debí crear su clase, así como los métodos necesarios para su ejecución y crear los comportamientos que necesitaba, en este caso \texttt{ConvertirseEnSabio}. Sin embargo, la parte mas difícil de esta implementación fue conseguir que el mundo avisase correctamente al \texttt{ayudante} cuando se producía un encuentro entre un \texttt{aspirante a heroe} y un \texttt{ladron}. Para ello, debí modificar el \texttt{Agente Mundo}, de manera que tomando como ejemplo el encuentro entre el \texttt{aspirante} y el \texttt{emboscador}, realicé uno parecido entre el \texttt{aspirante a heroe} y el \texttt{ladron} llamado \texttt{EncuentroLadron}, controlando como interactuaban estos agentes entre ellos, buscando en las páginas amarillas de JADE y mediante el intercambio de mensajes. Una vez se producía el encuentro entre estos dos agentes, el \texttt{Agente Mundo} se encargaba de avisar a los ayudantes a través del método \texttt{AcudeAyudante}, tal y como se especifica en el capitulo\ref{cap:Personajes:Aspirante}, donde nuevamente controlé el intercambio de mensajes entre estos agentes hasta que finalmente el ayudante llegaba. Por último, solo me quedaba realizar correctamente la planificación del ayudante, y junto con la ayuda de Oscar, conseguí acabarla satisfactoriamente.

Para finalizar, me comprometí en gran medida con el desarrollo y corrección de la memoria. En concreto, los capítulos que he desarrollado han sido: Resumen y su traducción, Introducción y su traducción, Primeros Pasos, Mapa, Personajes (en concreto, la clase Personaje, personajes, antagonistas, PNJ's, atributos y razas) y Conclusiones y su traducción.

\section{Trabajo realizado por Samuel Rodríguez Oliva}
En primer lugar para poder empezar a hablar de mi aportación al proyecto que se ha estado describiendo a lo largo de esta memoria hay que empezar por el trabajo de documentación que he ido realizando.
Al no haber trabajado previamente con Agentes ni con planificadores, le pedí al tutor toda la información posible sobre el proyecto del cual quería que partiésemos.
Aparte de la información del proyecto también nos pasó cinco documentos que trataban sobre Agentes, Sistemas Multi-Agentes y generadores de historias con Agentes, referencias donde ver como instalar y trabajar con JADE y una web (http://icaps-conference.org/index.php/Main/Competitions) para buscar información sobre planificación en IA en general y PDDL en particular. Toda esta información sirvió para empezar la investigación con alguna base.
A partir de aquí comencé a leer artículos relacionados con la generación de historias.
Esto me permitió conocer sistemas previos de generación de historias y que fue de gran ayuda para conocer que aspectos se habían trabajado previamente además de absorber nuevas ideas que intentar integrar en nuestro proyecto.
Para conocer estos sistemas es mejor ver el Capítulo \ref{cap:EstadoDeLaCuestion:Narrativa}.
 
Durante las primeras semanas fue crucial realizar reuniones cada dos semanas ya que en ellas nos solventaban dudas que habían surgido de una reunión a otra al ir probando cosas y trabajando sobre el proyecto para después realizar un \textit{brainstorming} con ideas plausibles para integrar en nuestro sistema.
Aunque no todas las ideas lanzadas en estas reuniones nos servían o podías ser implementas si recogimos algunas que han servido como pilares para el sistema.
Estos pilares fueron recogidos como los objetivos que queríamos conseguir y de los cuales se habla detalladamente en el Capitulo de \ref{cap:Objetivos}. 

Como se ve en el Capítulo \ref{cap:PrimerosPasos} estábamos bloqueados con la implementación ya que nos atamos, al principio, con el sistema de nuestros compañeros.
En estos primeros pasos trabajé en como hacer que la princesa no fuese un Agente objeto y ayudé a mis compañeros para intentar lograr que el caballero pudiese tener múltiples objetivos.
Al fracasar en estos objetivos decidimos partir de un sistema realizado por nosotros desde el principio y así no tener limitaciones que no fuesen impuestas por nosotros mismos.
En este punto repartimos el trabajo para avanzar de forma más eficiente y así aquí donde yo empecé a trabajar en primer lugar en la inclusión de los objetos en la historia.
Para ver más detalladamente este apartado consultar el Capítulo \ref{cap:Objetos}.
Ya que para algunos objetos necesitaba trabajar con la parte de planificación en momentos trabajamos conjuntamente Óscar y yo, él ayudándome con la integración de los objetos en el planificador y yo a él con el archivo de dominio del planificador en la creación de algunas acciones atómicas de los personajes. 
A la vez que trabajaba con los objetos también participé en la realización de los conceptos, tal cual se encuentran implementados actualmente, de atributos y razas, además de en la implementación del árbol de jerarquía de clases de los personajes.
Una vez implementado los objetos, mi esfuerzo se dedicó enteramente al apartado narrativo del sistema.

A pesar de ser un apartado importante en la generación de historias, he creído conveniente que la mejor opción no era que tuviese un capítulo propio para explicar el tema sino que fuese un apartado dentro del Capítulo de Personajes(\ref{cap:Personajes:Narrativa}), debido a que las historias generadas con nuestro sistema están centradas en los personajes y son estos los encargados de saber para cada acción que realizan la frase o frases correspondientes que pueden decir.

Por último he estado encargado de la realización de nuevos archivos de configuración XML e imágenes para poder probar que es posible que el sistema es capaz de crear nuevas historias en un ámbito diferente.
Para ver un ejemplo de esto mirar en el Capítulo \ref{cap:Simulaciones}.
Al ir probando estas diferentes configuraciones también e ido solventando problemas y errores que se encontraban en el sistema.

De forma paralela a la implementación del sistema me encargué de transferir a \emph{LaTeX} toda la información que hasta el momento había ido recogiendo tanto yo como mi compañero Juan.
Aquellos aspectos sobre los cuales he escrito han sido referentes principalmente a la parte de Narrativa Computacional dentro del Estado de la Cuestión, al Capítulo sobre los objetos así como al Capítulo de Simulaciones realizadas y al aparatado del Sistema Narrativo de los Personajes.
También he participado de forma importante en el desarrollo del Resumen, Introducción y Trabajo Futuro, además de en la reestructuración de los Capítulos  Primeros Pasos y Personajes.
Finamente mis últimos pasos en la realización de esta memoria se han enfocado en una corrección exhaustiva de todos los Capítulos además de una correcta colocación de imágenes, textos y códigos que se han utilizado como ejemplo o apoyo durante todo el documento.

\section{Trabajo realizado por Óscar David Vásquez Peraza}

Una vez que se realizaron los primeros procesos de \textit{brainstorming}, quedó bastante claro que las primeras aproximaciones que se debían hacer era familiarizarse con JADE, el lenguaje PDDL, y estudiar al fondo el sistema generador anterior.

En estas primeras fases, se trató de incorporar una serie de variaciones y nuevas funciones en el sistema base, sin mucho éxito. Entonces empece a crear sistemas simples usando JADE que ayudarían al resto de compañeros también a entender el funcionamiento de los agentes con mayor facilidad. Una vez hecho todo esto procedí con la reimplementación del sistema anterior parte por parte para poder tener una estructura limpia que nos permitiese realizar la implementación de las nuevas funciones.

Tras varias discusiones sobre las diferentes capas que iban a componer el sistema, se empieza a hacer el montaje del nuevo sistema. Una de las primeras funciones que se incorpora es la interfaz gráfica, puesto que nos permitiría interactuar con el sistema de una forma más cómoda.

El diseño e implementación de nuevos tipos de personajes requería no solo un buen manejo de JADE, sino que tambíen del lenguaje PDDL puesto este es quién declara y especifica las acciones que usan los personajes y que en función de las acciones que realicen serán un tipo de personaje en la historia. Todo esto lleva a empezar a diseñar el conjunto de instrucciones necesarias para disponer de un sistema multiobjetivos. Nos damos cuenta de que en lugar de crear un agente en concreto que solo realizaba cierto tipos de acciones, se puede hacer que el agente sea capaz de ejercer ciertos roles en función del tipo de objetivo que haya elegido realizar.

Así es como se empieza a hacer la ampliación del dominio pddl y crear nuevas acciones, con nuevos efectos sobre los personajes y que algunos servirían para personajes específicos y otras acciones más generales. Esto obliga ampliar el código para que cada personaje sea capaz de procesar las nuevas instrucciones que va recibiendo del planificador así como también aumentó drásticamente el número de variables de control en el sistema.

A la vista de la nueva magnitud que el sistema estaba tomando, fue necesario modificar el agente Mundo y la forma en la que manejaba cierta información. Debido a ciertas características del lenguaje pddl, la información que recibe cada personaje para generar su fichero de problema empezó a verse en la necesidad de ser filtrada, puesto que el tamaño de los archivos ha aumentado porque recogen toda la nueva información. Gran parte de esta información era irrelevante para cada personaje, o mejor dicho, a cada personaje sólo le interesa conocer cierta información, así que generar un archivo de problema pddl específico para cada personaje se convirtió en algo a implementar con alto nivel de urgencia.

El montaje del nuevo sistema permitía que implementar una serie nuevos personajes fuese más sencillo, empezando a implementar personajes como el emboscador, el asesino, el ladrón, la planificación de la víctima , así como darle la posibilidad de escapar por cuenta propia de su secuestrador.

Al implementar a estos personajes, crear y diseñar la forma en la que se dispararían eventos entre personajes que estuviesen funcionando de forma paralela se hace inmediatamente necesario para que estos personajes interactúen correctamente, con lo cuál me hago cargo de asegurarme que el agente Mundo sea capaz de manejar y controlar los eventos. A modo general, la mayor parte de mi trabajo está centrado en el estudio y diseño del funcionamiento y la lógica del sistema.

Respecto a la documentación, los capítulos realizados han sido Estado de la Cuestión(a excepción de la narrativa), Objetivos, Arquitectura y Trabajo Futuro, así como la revisión y corrección del resto del documento.